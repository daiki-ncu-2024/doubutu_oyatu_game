<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã©ã†ã¶ã¤ãŠã‚„ã¤ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ« */
        body {
            font-family: 'Arial', sans-serif; /* ãƒ•ã‚©ãƒ³ãƒˆæŒ‡å®š */
            background-color: #f0f9ff; /* èƒŒæ™¯è‰² */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .board-container {
            background-color: #fff; /* ãƒœãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã®èƒŒæ™¯è‰² */
            padding: 20px;
            border-radius: 12px; /* è§’ä¸¸ */
            box-shadow: 0 8px 16px rgba(0,0,0,0.1); /* å½± */
        }
        .board {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* 5åˆ— */
            grid-template-rows: repeat(4, 1fr);    /* 4è¡Œ */
            width: clamp(300px, 90vw, 500px); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªå¹… */
            height: clamp(240px, 72vw, 400px); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªé«˜ã• */
            border: 2px solid #60a5fa; /* ãƒœãƒ¼ãƒ‰ã®å¢ƒç•Œç·š (é’ç³») */
            border-radius: 8px; /* ãƒœãƒ¼ãƒ‰ã®è§’ä¸¸ */
            gap: 2px; /* ã‚»ãƒ«é–“ã®éš™é–“ */
            background-color: #93c5fd; /* ãƒœãƒ¼ãƒ‰ã®èƒŒæ™¯ (è–„ã„é’) */
        }
        .cell {
            background-color: #eff6ff; /* ã‚»ãƒ«ã®èƒŒæ™¯è‰² (éå¸¸ã«è–„ã„é’) */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.2rem, 4vw, 2rem); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º */
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
            border: 1px solid #dbeafe; /* ã‚»ãƒ«ã®å¢ƒç•Œç·š */
            border-radius: 4px; /* ã‚»ãƒ«ã®è§’ä¸¸ */
        }
        .cell:hover {
            background-color: #dbeafe; /* ãƒ›ãƒãƒ¼æ™‚ã®èƒŒæ™¯è‰² */
        }
        .piece-p1 { color: #2563eb; } /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ã®é§’ã®è‰² (é’) */
        .piece-p2 { color: #db2777; } /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2ã®é§’ã®è‰² (ãƒ”ãƒ³ã‚¯) */
        .selected {
            background-color: #fed7aa !important; /* é¸æŠã•ã‚ŒãŸé§’ã®èƒŒæ™¯è‰² (ã‚ªãƒ¬ãƒ³ã‚¸ç³») */
            outline: 2px solid #f97316; /* é¸æŠã•ã‚ŒãŸé§’ã®æ ç·š */
        }
        .valid-move {
            background-color: #a7f3d0 !important; /* ç§»å‹•å¯èƒ½ãªãƒã‚¹ã®èƒŒæ™¯è‰² (ç·‘ç³») */
            outline: 2px solid #059669;
        }
        .captured {
            opacity: 0.5;
            text-decoration: line-through;
        }
        .info-panel {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            text-align: center;
            width: clamp(300px, 90vw, 500px);
        }
        .info-panel h2 {
            font-size: clamp(1.2rem, 5vw, 1.8rem); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªã‚¿ã‚¤ãƒˆãƒ«ã‚µã‚¤ã‚º */
            margin-bottom: 10px;
            color: #1e3a8a; /* ã‚¿ã‚¤ãƒˆãƒ«ã®è‰² (æ¿ƒã„é’) */
        }
        .info-panel p {
            font-size: clamp(1rem, 4vw, 1.2rem); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚º */
            color: #374151; /* ãƒ†ã‚­ã‚¹ãƒˆã®è‰² */
            margin-bottom: 8px;
        }
        button {
            background-color: #3b82f6; /* ãƒœã‚¿ãƒ³ã®èƒŒæ™¯è‰² (é’) */
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: clamp(0.9rem, 3.5vw, 1.1rem);
            cursor: pointer;
            transition: background-color 0.2s;
            margin-top: 10px;
        }
        button:hover {
            background-color: #2563eb; /* ãƒ›ãƒãƒ¼æ™‚ã®ãƒœã‚¿ãƒ³èƒŒæ™¯è‰² */
        }
        /* ãƒ¢ãƒã‚¤ãƒ«ç”¨èª¿æ•´ */
        @media (max-width: 600px) {
            .board {
                gap: 1px;
            }
        }
    </style>
</head>
<body>
    <div class="board-container">
        <div id="gameBoard" class="board">
            </div>
    </div>

    <div id="infoPanel" class="info-panel">
        <h2 id="gameTitle">ã©ã†ã¶ã¤ãŠã‚„ã¤ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼</h2>
        <p id="turnDisplay">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ã®ç•ªã§ã™</p>
        <p id="messageDisplay"></p>
        <button id="resetButton">ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <script>
        // --- å®šæ•°å®šç¾© ---
        const BOARD_ROWS = 4;
        const BOARD_COLS = 5;
        const EMPTY_CELL = null; // ç©ºããƒã‚¹

        // é§’ã®ç¨®é¡ (çµµæ–‡å­—ã‚’ä½¿ã†ã¨ã‚ˆã‚Šå¯æ„›ã‚‰ã—ããªã‚Šã¾ã™)
        const PIECES = {
            LION: { name: "ãƒ©ã‚¤ã‚ªãƒ³", symbol: "ğŸ¦", p1Symbol: "ğŸ¦", p2Symbol: "ğŸº" }, // ç‹æ§˜é§’
            BEAR: { name: "ãã¾", symbol: "ğŸ»", p1Symbol: "ğŸ»", p2Symbol: "ğŸ¼" },   // ã‚¢ã‚¿ãƒƒã‚«ãƒ¼
            RABBIT: { name: "ã†ã•ã", symbol: "ğŸ°", p1Symbol: "ğŸ°", p2Symbol: "ğŸ¦Š" } // ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼
        };

        const PLAYER_1 = "P1";
        const PLAYER_2 = "P2";

        // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° ---
        let board = []; // ã‚²ãƒ¼ãƒ ç›¤ã®çŠ¶æ…‹ã‚’ä¿æŒã™ã‚‹2Dé…åˆ—
        let currentPlayer = PLAYER_1;
        let selectedPiece = null; // { r, c, piece (é§’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãã®ã‚‚ã®), player }
        let gameOver = false;

        // --- DOMè¦ç´  ---
        const gameBoardElement = document.getElementById('gameBoard');
        const turnDisplayElement = document.getElementById('turnDisplay');
        const messageDisplayElement = document.getElementById('messageDisplay');
        const resetButtonElement = document.getElementById('resetButton');

        // --- ã‚²ãƒ¼ãƒ åˆæœŸåŒ– ---
        function initializeBoard() {
            board = Array(BOARD_ROWS).fill(null).map(() => Array(BOARD_COLS).fill(EMPTY_CELL));
            gameOver = false;
            currentPlayer = PLAYER_1;
            selectedPiece = null;
            messageDisplayElement.textContent = "";
            updateTurnDisplay();

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1 (å…ˆæ‰‹) ã®é§’é…ç½® (ç›¤é¢ã®ä¸‹å´)
            board[3][0] = { type: PIECES.BEAR, player: PLAYER_1 };
            board[3][1] = { type: PIECES.RABBIT, player: PLAYER_1 };
            board[3][2] = { type: PIECES.LION, player: PLAYER_1 };
            board[3][3] = { type: PIECES.RABBIT, player: PLAYER_1 };
            board[3][4] = { type: PIECES.BEAR, player: PLAYER_1 };

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2 (å¾Œæ‰‹) ã®é§’é…ç½® (ç›¤é¢ã®ä¸Šå´)
            board[0][0] = { type: PIECES.BEAR, player: PLAYER_2 };
            board[0][1] = { type: PIECES.RABBIT, player: PLAYER_2 };
            board[0][2] = { type: PIECES.LION, player: PLAYER_2 };
            board[0][3] = { type: PIECES.RABBIT, player: PLAYER_2 };
            board[0][4] = { type: PIECES.BEAR, player: PLAYER_2 };

            renderBoard();
        }

        // --- ç›¤é¢æç”» ---
        function renderBoard() {
            gameBoardElement.innerHTML = ''; // æ—¢å­˜ã®ç›¤é¢ã‚’ã‚¯ãƒªã‚¢
            for (let r = 0; r < BOARD_ROWS; r++) {
                for (let c = 0; c < BOARD_COLS; c++) {
                    const cellElement = document.createElement('div');
                    cellElement.classList.add('cell');
                    cellElement.dataset.r = r;
                    cellElement.dataset.c = c;

                    const pieceData = board[r][c];
                    if (pieceData) {
                        cellElement.textContent = pieceData.player === PLAYER_1 ? pieceData.type.p1Symbol : pieceData.type.p2Symbol;
                        cellElement.classList.add(pieceData.player === PLAYER_1 ? 'piece-p1' : 'piece-p2');
                    }

                    if (selectedPiece && selectedPiece.r === r && selectedPiece.c === c) {
                        cellElement.classList.add('selected');
                    }

                    if (selectedPiece) {
                        const validMoves = getValidMoves(selectedPiece.r, selectedPiece.c, selectedPiece.player, selectedPiece.piece);
                        if (validMoves.some(move => move.r === r && move.c === c)) {
                            cellElement.classList.add('valid-move');
                        }
                    }
                    
                    cellElement.addEventListener('click', () => handleCellClick(r, c));
                    gameBoardElement.appendChild(cellElement);
                }
            }
        }

        // --- ã‚»ãƒ«ã‚¯ãƒªãƒƒã‚¯å‡¦ç† ---
        function handleCellClick(r, c) {
            if (gameOver) return;

            const clickedCellContent = board[r][c];

            if (selectedPiece) {
                const validMoves = getValidMoves(selectedPiece.r, selectedPiece.c, selectedPiece.player, selectedPiece.piece);
                const isMoveValid = validMoves.some(move => move.r === r && move.c === c);

                if (isMoveValid) {
                    movePiece(selectedPiece.r, selectedPiece.c, r, c);
                } else if (clickedCellContent && clickedCellContent.player === currentPlayer) {
                    selectedPiece = { r, c, piece: clickedCellContent.type, player: clickedCellContent.player };
                    messageDisplayElement.textContent = `${selectedPiece.piece.name}ã‚’é¸æŠä¸­ã€‚`;
                } else {
                    messageDisplayElement.textContent = "ãã“ã«ã¯ç§»å‹•ã§ãã¾ã›ã‚“ã€‚ä»–ã®é§’ã‚’é¸ã¶ã‹ã€æœ‰åŠ¹ãªãƒã‚¹ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚";
                    selectedPiece = null; 
                }
            } else {
                if (clickedCellContent && clickedCellContent.player === currentPlayer) {
                    selectedPiece = { r, c, piece: clickedCellContent.type, player: clickedCellContent.player };
                    messageDisplayElement.textContent = `${selectedPiece.piece.name}ã‚’é¸æŠã—ã¾ã—ãŸã€‚ç§»å‹•å…ˆã‚’é¸ã‚“ã§ãã ã•ã„ã€‚`;
                } else if (clickedCellContent) {
                    messageDisplayElement.textContent = "ç›¸æ‰‹ã®é§’ã§ã™ã€‚è‡ªåˆ†ã®é§’ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚";
                } else {
                     messageDisplayElement.textContent = "é§’ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚";
                }
            }
            renderBoard();
        }

        // --- é§’ã®ç§»å‹• ---
        function movePiece(fromR, fromC, toR, toC) {
            const pieceToMove = board[fromR][fromC];
            const targetContent = board[toR][toC];

            if (targetContent && targetContent.type === PIECES.LION) {
                board[toR][toC] = pieceToMove;
                board[fromR][fromC] = EMPTY_CELL;
                renderBoard();
                gameOver = true;
                messageDisplayElement.textContent = `${currentPlayer === PLAYER_1 ? "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1" : "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2"} ã®å‹åˆ©ï¼ ${targetContent.type.name} ã‚’å–ã‚Šã¾ã—ãŸï¼`;
                turnDisplayElement.textContent = "ã‚²ãƒ¼ãƒ çµ‚äº†";
                selectedPiece = null;
                return;
            }

            if (targetContent) {
                 messageDisplayElement.textContent = `${pieceToMove.type.name}ã§ç›¸æ‰‹ã®${targetContent.type.name}ã‚’å–ã‚Šã¾ã—ãŸï¼`;
            } else {
                 messageDisplayElement.textContent = `${pieceToMove.type.name}ã‚’ç§»å‹•ã—ã¾ã—ãŸã€‚`;
            }

            board[toR][toC] = pieceToMove;
            board[fromR][fromC] = EMPTY_CELL;
            
            selectedPiece = null;
            switchPlayer();
        }

        // --- æœ‰åŠ¹ãªç§»å‹•å…ˆã®å–å¾— (é§’ã®å‹•ããƒ«ãƒ¼ãƒ«æ›´æ–°) ---
        function getValidMoves(r, c, player, pieceType) {
            const moves = [];
            let dr, dc; 

            if (!pieceType) return moves;

            // ãƒ©ã‚¤ã‚ªãƒ³ã®å‹•ã: å‰å¾Œå·¦å³ã«1ãƒã‚¹
            if (pieceType === PIECES.LION) {
                const deltas = [ [-1, 0], [1, 0], [0, -1], [0, 1] ]; // ä¸Š, ä¸‹, å·¦, å³
                for (const [deltaR, deltaC] of deltas) {
                    const nr = r + deltaR;
                    const nc = c + deltaC;
                    if (isValidSquare(nr, nc, player)) moves.push({ r: nr, c: nc });
                }
            }
            // ãã¾ã®å‹•ã: å‰ã«1ãƒã‚¹ã€ã¾ãŸã¯æ–œã‚å‰ï¼ˆå·¦å³ã©ã¡ã‚‰ã‹ï¼‰ã«1ãƒã‚¹
            else if (pieceType === PIECES.BEAR) {
                dr = (player === PLAYER_1) ? -1 : 1; // P1ã¯ä¸Šã¸(è¡ŒãŒæ¸›ã‚‹)ã€P2ã¯ä¸‹ã¸(è¡ŒãŒå¢—ãˆã‚‹)
                // å‰
                if (isValidSquare(r + dr, c, player)) moves.push({ r: r + dr, c: c });
                // æ–œã‚å‰ï¼ˆå·¦ï¼‰
                if (isValidSquare(r + dr, c - 1, player)) moves.push({ r: r + dr, c: c - 1 });
                // æ–œã‚å‰ï¼ˆå³ï¼‰
                if (isValidSquare(r + dr, c + 1, player)) moves.push({ r: r + dr, c: c + 1 });
            }
            // ã†ã•ãã®å‹•ã: æ–œã‚å‰ï¼ˆå·¦å³ã©ã¡ã‚‰ã‹ï¼‰ã«1ãƒã‚¹ã€ã¾ãŸã¯çœŸæ¨ªï¼ˆå·¦å³ã©ã¡ã‚‰ã‹ï¼‰ã«1ãƒã‚¹
            else if (pieceType === PIECES.RABBIT) {
                dr = (player === PLAYER_1) ? -1 : 1; // P1ã¯ä¸Šã¸ã€P2ã¯ä¸‹ã¸
                // æ–œã‚å‰ï¼ˆå·¦ï¼‰
                if (isValidSquare(r + dr, c - 1, player)) moves.push({ r: r + dr, c: c - 1 });
                // æ–œã‚å‰ï¼ˆå³ï¼‰
                if (isValidSquare(r + dr, c + 1, player)) moves.push({ r: r + dr, c: c + 1 });
                // çœŸæ¨ªï¼ˆå·¦ï¼‰
                if (isValidSquare(r, c - 1, player)) moves.push({ r: r, c: c - 1 });
                // çœŸæ¨ªï¼ˆå³ï¼‰
                if (isValidSquare(r, c + 1, player)) moves.push({ r: r, c: c + 1 });
            }
            return moves;
        }

        // --- ãƒã‚¹ã®æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯ ---
        function isValidSquare(r, c, player) {
            if (r < 0 || r >= BOARD_ROWS || c < 0 || c >= BOARD_COLS) {
                return false; // ç›¤å¤–
            }
            const targetCell = board[r][c];
            if (targetCell && targetCell.player === player) {
                return false; // ç§»å‹•å…ˆã«è‡ªåˆ†ã®é§’
            }
            return true; // ç©ºããƒã‚¹ã€ã¾ãŸã¯ç›¸æ‰‹ã®é§’ã®ãƒã‚¹
        }

        // --- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼äº¤ä»£ ---
        function switchPlayer() {
            currentPlayer = (currentPlayer === PLAYER_1) ? PLAYER_2 : PLAYER_1;
            updateTurnDisplay();
            if (!gameOver) {
                 messageDisplayElement.textContent = ""; 
            }
            renderBoard(); 
        }

        // --- è¡¨ç¤ºæ›´æ–° ---
        function updateTurnDisplay() {
            turnDisplayElement.textContent = gameOver ? "ã‚²ãƒ¼ãƒ çµ‚äº†" : `${currentPlayer === PLAYER_1 ? "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1 (ä¸‹å´)" : "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2 (ä¸Šå´)"} ã®ç•ªã§ã™`;
        }

        // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ---
        resetButtonElement.addEventListener('click', initializeBoard);

        // --- ã‚²ãƒ¼ãƒ é–‹å§‹ ---
        initializeBoard();
    </script>
</body>
</html>
